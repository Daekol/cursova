<div class="row">
  <div class="col-md-8">
    <h1 class="display-4"><%= @trade.title %></h1>
    <div class="content">
      <p class="pb-3 border-bottom">Posted <%= time_ago_in_words(@trade.created_at) %> ago</p>
      <div class="pt-1"><%= sanitize markdown_to_html(@trade.description) %></div>
    </div>

    <% if @trade.images.attached? %>
      <div class="row">
        <% @trade.images.each do |image| %>
          <div class="col-md-4 mb-3">
            <%= link_to image_tag(rails_blob_path(image, only_path: true).to_s, class: "img-fluid img-thumbnail", alt: "Trade Image"), rails_blob_path(image, only_path: true) %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>

  <div class="col-md-3 offset-md-1">
    <% if trade_author(@trade) %>
      <div class="bg-light p-3 mb-4 rounded">
        <p class="font-weight-bold pb-1">Author actions:</p>
        <div class="btn-group" role="group">
          <%= link_to "Edit trade: #{@trade.title}", edit_trade_path(@trade), class: 'btn btn-sm btn-primary' %>
          <%= link_to "Back", trades_path, class: "btn btn-sm btn-secondary" %>
        </div>
      </div>
    <% end %>
    <div class="mb-4">
      <p class="text-left font-weight-bold">Trade author:</p>
      <div class="d-inline-block align-top mr-2"><%= gravatar_for @trade.user, size: 32 %></div>
      <div class="d-inline-block align-top"><%= @trade.user.email %></div>
    </div>
    <% if user_signed_in? && current_user.id != @trade.user_id %>
      <%= link_to "Message #{@trade.user.email}", conversations_path(sender_id: current_user.id, recipient_id: @trade.user.id), method: 'post', class: "btn btn-link" %>
    <% elsif user_signed_in? && current_user.id == @trade.user_id  %>
      <%= link_to "Conversations", conversations_path, class: "btn btn-link" %>
    <% else %>
      <%= link_to "Sign up to message #{@trade.user.email}", new_user_registration_path, class: "btn btn-link" %>
    <% end %>
  </div>
</div>
